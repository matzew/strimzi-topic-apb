FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHN0cmltemktdG9waWMtYXBiCmRlc2NyaXB0aW9uOiBTdHJpbXpp\
IHRvcGljIG1hbmFnZW1lbnQKYmluZGFibGU6IEZhbHNlCmFzeW5jOiBvcHRpb25hbAptZXRhZGF0\
YToKICBkaXNwbGF5TmFtZTogU3RyaW16aSBUb3BpYwogIGltYWdlVXJsOiAiaHR0cHM6Ly9hdmF0\
YXJzMi5naXRodWJ1c2VyY29udGVudC5jb20vdS8zNDc2NzQyOD9zPTIwMCZ2PTQiCiAgZG9jdW1l\
bnRhdGlvblVybDogImh0dHA6Ly9zdHJpbXppLmlvL2RvY3MvbWFzdGVyIgogIHByb3ZpZGVyRGlz\
cGxheU5hbWU6ICJSZWQgSGF0LCBJbmMuIgpwbGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRl\
c2NyaXB0aW9uOiBUaGlzIGRlZmF1bHQgcGxhbiBkZXBsb3lzIHN0cmltemktdG9waWMtYXBiCiAg\
ICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToge30KICAgIHBhcmFtZXRlcnM6IAogICAgLSBuYW1l\
OiB0b3BpY19uYW1lCiAgICAgIHRpdGxlOiBOYW1lIG9mIHRoZSBUb3BpYyBmb3IgU3RyaW16aQog\
ICAgICB0eXBlOiBzdHJpbmcKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIC0gbmFtZTogcGFydGl0\
aW9uX2NvdW50CiAgICAgIHRpdGxlOiBOdW1iZXIgb2YgcGFydGl0aW9ucyBmb3IgdGhlIHRvcGlj\
ICAgICAgCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIGRlZmF1bHQ6IDEKICAgICAgdHlwZTog\
c3RyaW5nCiAgICAtIG5hbWU6IGludAogICAgICB0aXRsZTogTnVtYmVyIG9mIHJlcGxpY2FzIGZv\
ciB0aGUgdG9waWMgICAgICAKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgZGVmYXVsdDogMQog\
ICAgICB0eXBlOiBpbnQK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
